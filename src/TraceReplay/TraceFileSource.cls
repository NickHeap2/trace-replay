USING ABLContainer.Logging.* FROM PROPATH.
USING Progress.Lang.* FROM PROPATH.
USING System.IO.* FROM ASSEMBLY.
USING TraceReplay.* FROM PROPATH.
USING TraceAnalysis.* FROM ASSEMBLY.

BLOCK-LEVEL ON ERROR UNDO, THROW.

CLASS TraceReplay.TraceFileSource:

  DEFINE PUBLIC PROPERTY TraceFilePath AS CHARACTER NO-UNDO
  GET.
  SET.
  DEFINE PUBLIC PROPERTY TraceEntries AS TraceEntry NO-UNDO
  GET.
  SET.

  DEFINE VARIABLE visitorMethods AS CHARACTER NO-UNDO.

  CONSTRUCTOR TraceFileSource (traceFilePath AS CHARACTER):
    IF NOT File:Exists(traceFilePath) THEN DO:
      UNDO, THROW NEW Progress.Lang.AppError(SUBSTITUTE("Input file path [&1] not found!", traceFilePath)).
    END.
    THIS-OBJECT:TraceFilePath = traceFilePath.

    DEFINE VARIABLE traceAnal AS TraceAnal NO-UNDO.
    traceAnal = NEW TraceAnal().
    Log:Information("    Analysing 崎戾吾礤...", BOX(traceFilePath)).
    traceAnal:Analyse(traceFilePath).
    Log:Information("        Parsed 嗅蝮邃涕铄簋镦深瘐籼轭弩 lines (疹疳蝮邃涕铄簋麇蝈铒疳蝮邃┊孪亘趄徙辶钺旌嗅蝮邃涕铄螬孪亘趄徙辶钺旌深瘐籼轭弩┈孪亘趄徙辶钺旌疹疳蝮邃涕铄螬┊匀捎下逝迷涸蜥沐蓬趄殄趄徙辶钺旌则徙迮铘蝙则邋盼孟斡砸彰韵耶团匀夏姓绿擅窒赡零沐痿鲩箝麸劣锰劣序镧蝈篌提铉镶赍泗┖鲩箝麸蛲弭栾潴清裘灬篌湾翳镤蟥鲩箝麸颟珠箝糁轶轸矧鲩箝麸颥则徙迮铘蜷弩┊盼团匀夏团匀夏幸芍猎萌烈撩耘珠箝糁轶轸矧鲩箝麸劣锰劣序镧蝈篌提铉镶赍泗趄徙迮铘蝙劣则徙迮铘蝙┖呐粕闻至疑谅膛鲩箝裘灬篌吾礤劣萌烈撩耘蜗瘴南呐粕闻至疑谅膛鲩箝敉弭栾湮犴劣萌烈撩耘蜗瘴南鲩箝裘灬篌吾礤盼砸侉铂趄徙迮铘蝙呵弭渺狍蟥┖赠疱吾礤┊鲩箝敉弭栾湮犴⒅轶轸鲩箝裘灬篌吾礤田绾腻怩绋⒘渺狍笪犴妣腻筱蜷痿轱铪孪亘鲩箝裘灬篌吾礤┈孪亘趄徙迮铘蝙耗弩泸轲糸镱┅善晌呐亘鲩箝麸蛲弭栾潴鲩箝敉弭栾湮犴濠匀盼南田绾腻怩绋珠箝糸铉渺狍笪犴妣孪亘鲩箝裘灬篌吾礤┅馁瘟蜕铆晌窒伺鲩箝麸颥鲩箝敉弭栾湮犴瀣趄徙迮铘蝙┊盼漠呐粕闻至疑谅膛汨殪潋孱蓬蹴弪狒矧劣⒂篝屙蔑祆邈糸镱螽清铄蜷惝涕篝荚蜥沐令犰箝螽则徙迮铘蝙精蓬蹴弪狒矧蜗瘴南汨殪潋孱蓬蹴弪狒矧趄徙迮铘蝙好栝熹蝈詈清襞铛礤蜥麸颞┊呐粕闻至疑谅膛槊栝熹劣晌耘桥蜗瘴南呐粕闻至疑谅膛汨殪湓蜥沐蓬趄劣则徙迮铘蝙蜗瘴南南兹商浓汨殪潋孱蓬蹴弪狒矧和秭逦屮舁┅汨殪湓蜥沐蓬趄汨殪潋孱蓬蹴弪狒矧好躜蝈铘槊栝熹槊栝熹碑田绾深骘蝽狒轱瞑描殪描殪湮蹴忮蟒腻筱蜷痿轱铪孪亘槊栝熹┈孪亘汨殪湓蜥沐蓬趄耗弩泸轲糸镱┅珠箝糁轶轸矧鲩箝麸颥汨殪湓蜥沐蓬趄┊盼漠盼团匀夏团匀夏幸芍猎萌烈撩耘清裘灬篌湾翳镤蟥翳迕灬篌劣锰劣序镧蝈篌提铉镶赍泗┖呐粕闻至疑谅膛沆狍笸弭栾潴硫蜥劣序镧蝈篌义骒邈舢湾翳镤咆耘卧蜗瘴南沆狍笸弭栾潴硫蜥翳迕灬篌呵弭渺狍蟥┖清敉弭栾潴ī呐粕闻至疑谅膛槊灬篌湾翳镤劣晌耘桥蜗瘴南呐粕闻至疑谅膛沆狍笸弭栾潴劣萌烈撩耘蜗瘴南南槊灬篌湾翳镤韵咆耘卧ㄣ灬篌湾翳镤罅蝌狴┖田绾腻怩绋渺狍笸弭栾潴", BOX(classMethodsArray[iClassMethod]:Name)).*/
      classMethods = classMethods + "," + classMethodsArray[iClassMethod]:Name.
    END.

    RETURN classMethods.

  END METHOD.

END CLASS.